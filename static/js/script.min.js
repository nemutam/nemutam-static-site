function deobfuscate(t){for(var e=[],n=[],i=0;i<t.length;i++)i%2==0?e.push(t[i]):n.push(t[i]);e.reverse();var a=[];for(i=0;i<Math.max(e.length,n.length);i++)i<e.length&&a.push(e[i]),i<n.length&&a.push(n[i]);return a=a.join("")}function getCookie(t){var e=null;if(document.cookie&&""!==document.cookie)for(var n=document.cookie.split(";"),i=0;i<n.length;i++){var a=jQuery.trim(n[i]);if(a.substring(0,t.length+1)===t+"="){e=decodeURIComponent(a.substring(t.length+1));break}}return e}function logInteraction(t,e){$.ajax({method:"POST",url:"/api/"+t+"_ad/",data:e,headers:{"X-CSRFToken":getCookie("csrftoken")}}).done(function(t,e,n){}).fail(function(t,e,n){console.error(n)})}$('[data-toggle="tooltip"]').tooltip(),$(".mail-link").each(function(){var t=deobfuscate($(this).attr("href").trim()),e=deobfuscate($(this).html().trim());$(this).attr("href",t),$(this).html(e)}),$(".ad-container img").click(function(){logInteraction("click",{campaign_id:this.dataset.campaignId,device:this.dataset.device})});var observerCallback=function(t,e){$.each(t,function(t,n){n.isIntersecting&&(logInteraction("view",{campaign_id:n.target.dataset.campaignId,device:n.target.dataset.device}),e.unobserve(n.target))})},observer=new IntersectionObserver(observerCallback,{threshold:.9});$(".ad-container img").each(function(){observer.observe(this)}),0!==$(".listing-buttons button").length&&($.ajax({method:"GET",url:"/api/get_saved_listing_ids/",headers:{"X-CSRFToken":getCookie("csrftoken")}}).done(function(t,e,n){$(".listing-buttons button").each(function(){var e=parseInt(this.dataset.listingId);if(-1!==t.indexOf(e)){var n=$(this).find("i");n.removeClass("far"),n.addClass("fas")}})}).fail(function(t,e,n){console.error(n)}),$(".listing-buttons button").click(function(){var t={listing_id:this.dataset.listingId},e=$(this).find("i"),n=e.hasClass("far")?"fas":"far";$.ajax({method:"POST",url:"/api/toggle_save_listing/",data:t,headers:{"X-CSRFToken":getCookie("csrftoken")}}).done(function(t,i,a){e.removeClass("far fas"),e.addClass(n)}).fail(function(t,e,n){console.error(n)})}));
